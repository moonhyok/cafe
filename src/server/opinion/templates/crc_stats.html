<!DOCTYPE html>
<head>
	<meta name='viewport' content='user-scalable=no, width=device-width,initial-scale=1, maximum-scale=1' />
  <script src="http://d3js.org/d3.v3.min.js"></script>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css" />
<link rel="stylesheet" href="{{url_root}}/media/mobile/css/stats.css" />
<script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js?2"></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/jquery-mobile/jquery-1.10.2.min.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/cartogram.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/topojson.js'></script>

	<script type='text/javascript'>
		window.userhist1_url="{{url_root}}/media/mobile/img/dailyupdate/{{uid}}_1.png"
		window.userhist2_url="{{url_root}}/media/mobile/img/dailyupdate/{{uid}}_2.png"
		window.show_hist1={{show_hist1}}
		window.show_hist2={{show_hist2}}	
		window.id={{uid}}
    $( document ).ready(function() {
    $(".spanish").hide();
});
    </script>
</head>
<style>

</style>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css" />
<link rel="stylesheet" href="{{url_root}}/media/mobile/css/stats.css" />
<script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js?2"></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/jquery-mobile/jquery-1.10.2.min.js'></script>
<script>console.log(window.id);</script>

<!--<div class="home-btn-dialog-box">
    <img width="30px;" class='back-btn-dialog' src="{{url_root}}/media/mobile/img/cafe/CRC_back_bttn.png">
    <a href="{{url_root}}/?refer={{entrycode}}"><img width="30px;" id="home-btn" class='home-btn-dialog' src="{{url_root}}/media/mobile/img/cafe/CRC_home_bttn.png"></a>
    <img width="30px;" id="help-btn" class='help-btn-dialog' src="{{url_root}}/media/mobile/img/cafe/CRC_help_bttn.png">
</div>-->

<br>
<center>
{%if level8%}
<div class="stats-section">
Thank you for suggesting an issue for the next California Report Card!
<br><br>

<span>Your participant score is {{score}}.</span>
You can increase your score anytime by returning to grade more suggestions by other participants: <a href="{{url_root}}/?refer={{entrycode}}" target="_blank">California Report Card</a>.<br><br>

Your participation score grows as you grade the issues others have suggested (100 points for each up to 10,000 points), and based on how others grade the issue you suggested (up to 30,000 points).<br><br>
</div>
{%endif%}

<br>
<hr>


<div class="stats-section-title">
    <div class="stats-label-big">
        Your Suggestion:
    </div>
</div>
<br>
{% if left_comment %}
<div class="stats-section-title">
    <div class="issue-text">
        <span style="font-size:14px;"><b>{{comment}}</b></span>
    </div>
</div>
{% else %}
  
  <div class="stats-section-title">
	   <span class="fine-print">You haven't suggested an issue. Please visit the report card and suggest an issue</span>
  </div>

{% endif %}

<br>
<hr>

    <!--<div class="stats-section">
    Data as of <strong>{{date}}</strong><br>
</div> -->

<br>
<div class="stats-section-title">
    <div class="stats-label-big">
        Your Suggestion's Grades
    </div>
</div>

{% if level8 %}
   {% if left_comment %}
     <br>
     <div class="stats-section-title" id="userhist">

         <center>
         <div class="responsive-div-1">
             <div style="text-align:left;min-height:30px;">"How important is this issue for the next Report Card?"</div>
             <div class="stat-img" id="userhist1"></div><br>
         </div>

         <div class="responsive-div-2" style="display: none;">
            <div style="text-align:left;min-height:30px;">"How would you grade California on this issue?"</div>
             <div class="stat-img" id="userhist2"></div><br>
         </div>
         </center>
     
     </div>

   {% else %}
      <br>
      <div class="stats-section-title">
	  <span class="fine-print">You haven't suggested an issue. Please visit the report card and suggest an issue</span>
      </div>
   {% endif %}

{% else %}
  <div class="stats-section-title">
	   <span class="fine-print">Please visit the report card, suggest an issue, and leave your email to see how others grade your idea</span>
  </div>
{% endif %}

<br>
<hr>

<div class="stats-section-title">
<div class='dialog dialog-style'>
  <center>       
          {% for k,v in statement_hist.iteritems %}
          
    <div class="compare-box-{{k.id}}" style="padding-bottom: 10px;width: 310px; margin: 20px; display: inline-block">
            
            <span class="english">{{k.statement}}</span>
            <span class="spanish">{{k.spanish_statement}}</span>

            <canvas id="sparkLineCanvas{{k.id}}" width="300" height="80"></canvas>
            
            <div>

        <script>
         var canvas = document.getElementById('sparkLineCanvas{{k.id}}');
         var context = canvas.getContext('2d');

         //if ({{k.id}} % 2 == 1)
         //    $('.compare-box-{{k.id}}').css("background-color","rgba(0,0,0,0.05)")

         var data = {{v}};
         var max_of_array = Math.max.apply(Math, data);

         //window.statement_processed_data[({{k.id}}-1)] = data

         context.beginPath();
         context.lineWidth = 10;
         context.strokeStyle = '#442b10';
         context.shadowColor = '#ffffff';
               context.shadowOffsetX = 1;
               context.shadowOffsetY = 1;
         //context.moveTo(0, 45 - data[0]/max_of_array*38);
         for (i = 0; i <= 13; i++)
         {
          var skipOffset = 0
          if (i == 13)
            skipOffset = 7

     context.moveTo(i*21+5+skipOffset, 68);
     context.lineTo(i*21+5+skipOffset, 68 - data[i]/max_of_array*65);
     context.stroke(); 
         }

         context.font="italic small-caps bolder 12px sans-serif";
         context.fillStyle = '#442b10';
         context.fillText("A+",0,80);

         context.fillText("F",163,80);
         context.fillText("Ø",277,80);
        </script>

      </div>
            
          </div>
          {% endfor %}

      </div>
</div>
<br>
<hr>


<div class="stats-section-title" id="geodistribution">
    <div class="stats-label-big">
        <span class="english">Median Grades For Each County</span>
        <span class="spanish">El número medio</span>
    </div><br>

    <select id="CA_selector" class="english" onchange="changeData(this)" >
  {% for median in medians %}
  <option value="{{median.id}}">{{median.id}}. {{ median.statement.short_version}}</option>
  {% endfor %}
    </select>

    <select id="CA_selector" class="spanish" onchange="changeData(this)" >
    {% for median in medians %}
    <option value="{{median.id}}">{{median.id}}. {{ median.statement.spanish_short_version}}</option>
    {% endfor %}
    </select>

    <br/><br>

    <!--<script>
        $.get("{{url_root}}/media/mobile/js/geostat.js")
            .fail(function() { 
            $( "#geodistribution" ).html( "<div class='stats-label-big'>GEOGRAPHIC DISTRIBUTION <br/> OF MEDIAN GRADES ASSIGNED</div><br><br><span style=' font-size:14px;color: #f5ebde;'>We will present geographical distribution soon</span><br/><br>" );
            document.getElementById( "#geodistribution" ).style.height="40px";
            })
    </script>-->
    <center>
        <button type="button" onclick="map_grade_update()">Click to transform the map to a cartogram</button>
        <div id="map" style="height: 370px; width:360px;"></div>
        The cartogram distorts the map so that each county's area is proportional to its population.
</center>
</div>
<br>
<hr>
<div class="stat-section-title" id="geopercapita">
     <div class="stats-label-big">
        Participants per 10,000 County Residents
    </div><br>
    <!--<script>
        $.get("{{url_root}}/media/mobile/js/geostat_population.js")
            .fail(function() { 
            $( "#geopercapita" ).html( "<div class='stats-label-big'>PARTICIPANTS PER  <br/> 10000 POPULATION</div><br><br><span style=' font-size:14px;color: #f5ebde;'>We will present geographical participantion soon</span><br/><br>" );
            document.getElementById( "#geodistribution" ).style.height="40px";
            })
    </script>-->
    <button type="button" onclick="map_capita_update()">Click to transform the map to a cartogram</button>
    <div id="map_capita" style="height: 370px; width:360px;"></div>
    The cartogram distorts the map so that each county's area is proportional to its population.
</div>
<br>
<hr>

	</center>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/crcstats.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/map_capita_carto.js'></script>
<script type='text/javascript' src='{{url_root}}/media/mobile/js/map_grade_carto.js'></script>
</body>
</html>
